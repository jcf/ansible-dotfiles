#!/usr/bin/env ruby
# Tor's excellent Spork + Autospec wrapper
# http://gist.github.com/210448

`ps | grep /spork$ | grep -v grep`

if $?.success?
  exec('autospec')
else
  IO.popen('(spork&) 2>&1') do |messages| 
    puts(message = messages.gets) until message =~ /ready/
    exec('autospec')
  end
end
